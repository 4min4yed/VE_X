<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VEx - Analyze</title>
    <link rel="stylesheet" href="analyze.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>

<body>

    <div id="site-header"></div>

    <!-- MAIN CONTENT -->
    <main class="analyze-wrapper">

        <h1 class="page-title">
            <i class="fas fa-microscope"></i> Analyze a File
        </h1>
        <p class="subtitle">Upload an executable to run it inside our secure virtual sandbox.</p>

        <!-- UPLOAD SECTION -->
        <div class="upload-card">
            <form onsubmit="return false;"></form>
                <!--<label for="file-upload" class="upload-zone">-->
                <div class="upload-zone" onclick="document.getElementById('file-upload').click()"></div>
                    <i class="fas fa-cloud-upload-alt"></i>
                    <p>Drag & Drop your file here</p>
                    <span>or click to browse</span>
                </label>

                <input id="file-upload" type="file" hidden>

                <button type="button" class="btn-primary start-btn">
                    Start Analysis <i class="fas fa-arrow-right"></i>
                </button>   
            </form>
        </div> 

        <script>    
            document.querySelector('.start-btn').addEventListener('click', async (event) => {
                event.preventDefault();
                event.stopPropagation();
    const fileInput = document.getElementById('file-upload');
    if (fileInput.files.length === 0) {
        alert('Please select a file first.');
        return;
    }
    const file = fileInput.files[0];
    
    const formData = new FormData();
    formData.append('file', file);
    
    try {
        const response = await fetch('http://localhost:6560/api/analyze', {
            method: 'POST',
            body: formData
        });
        if (response.ok) {
            const result = await response.json();
            console.log('Analysis result:', result);
            document.getElementById('file-id').textContent = result.id;
            document.getElementById('file-hash').textContent = result.hash;
            document.getElementById('response').textContent = result.status;


        } else {
            console.error('Upload failed:', response.statusText);
        }
    } catch (error) {
        console.error('Error uploading file:', error);
    }
});

        </script>

        <div>
  <p>File ID: <span id="file-id"></span></p>
  <p>File Hash: <span id="file-hash"></span></p>
  <p><span id="response"></span></p>

</div>

        
        <!-- INFO CARDS -->
        <div class="info-grid">

            <div class="info-card">
                <i class="fas fa-shield-virus"></i>
                <h3>Malware Detection</h3>
                <p>Behavioral and signature-based detection to identify malicious traits.</p>
            </div>

            <div class="info-card">
                <i class="fas fa-network-wired"></i>
                <h3>Network Monitoring</h3>
                <p>Outbound connections, DNS requests, packets and suspicious traffic.</p>
            </div>

            <div class="info-card">
                <i class="fas fa-folder-tree"></i>
                <h3>File System Tracking</h3>
                <p>Creation, deletion or modifications of sensitive system files.</p>
            </div>

            <div class="info-card">
                <i class="fas fa-memory"></i>
                <h3>Runtime Behavior</h3>
                <p>API calls, memory mapping and process injection attempts.</p>
            </div>

        </div>

    </main>

    <div id="site-footer"></div>
    <script src="partials/load-partials.js"></script>

</body>
</html>
